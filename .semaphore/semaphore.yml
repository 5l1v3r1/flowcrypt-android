version: v1.0
name: FlowCrypt Android App

agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: Build

    execution_time_limit:
      minutes: 2

    task:
      env_vars:
        - name: SEMAPHORE_GIT_DIR
          value: /home/semaphore/git/flowcrypt-android
        - name: ANDROID_SDK_ROOT
          value: /usr/lib/android-sdk
        - name: ANDROID_BIN
          value: /usr/lib/android-sdk/tools/bin
      jobs:
        - name: Build
          commands:
            - sudo apt update && sudo apt-get -y install android-sdk
            - yes | $ANDROID_BIN/sdkmanager --licenses
            - checkout
            - cd ~/git/flowcrypt-android
            - ./gradlew assembleProdDebug

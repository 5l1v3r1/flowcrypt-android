version: v1.0
name: FlowCrypt Android App

agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: Build

    execution_time_limit:
      minutes: 5

    task:
      env_vars:
        - name: SEMAPHORE_GIT_DIR
          value: /home/semaphore/git/flowcrypt-android
        - name: ANDROID_SDK_ROOT
          value: /usr/lib/android-sdk
        - name: ANDROID_BIN
          value: /usr/lib/android-sdk/tools/bin
      jobs:
        - name: Build
          commands:
            - sudo apt update && sudo apt-get -y install android-sdk
            - wget https://dl.google.com/android/repository/sdk-tools-linux-4333796.zip
            - unzip sdk-tools-linux-4333796.zip
            - sudo mv tools/bin/* /usr/lib/android-sdk/tools/bin
            - export PATH=$PATH:$ANDROID_BIN
            - ls $ANDROID_BIN
            - yes | sdkmanager --licenses
#            - checkout
#            - cd ~/git/flowcrypt-android
#            - ./gradlew assembleProdDebug
